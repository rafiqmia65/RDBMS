# Foreign Key Explained & Adding Foreign Key Constraints (SQL & PostgreSQL)

This document provides a **professional and practical explanation of Foreign Keys**, including how to **add foreign key constraints** in **SQL and PostgreSQL**. It is suitable for `README.md`, GitHub documentation, and interview preparation.

---

## 1. What Is a Foreign Key?

A **Foreign Key (FK)** is a column (or group of columns) in one table that **references the Primary Key** of another table.

It is used to:

- Maintain **referential integrity**
- Enforce valid relationships between tables
- Prevent orphan records

---

## 2. Parent Table vs Child Table

- **Parent Table** → Contains the referenced `PRIMARY KEY`
- **Child Table** → Contains the `FOREIGN KEY`

Example:

- `users(id)` → Parent
- `orders(user_id)` → Child

---

## 3. Basic Foreign Key Syntax

```sql
FOREIGN KEY (child_column)
REFERENCES parent_table(parent_column)
```

---

## 4. Creating Tables with Foreign Key

### 4.1 Parent Table

```sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  name VARCHAR(50) NOT NULL
);
```

---

### 4.2 Child Table with Foreign Key

```sql
CREATE TABLE orders (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  order_date DATE NOT NULL
);
```

✔ Ensures `user_id` must exist in `users(id)`.

---

## 5. Adding Foreign Key Using ALTER TABLE

Foreign keys can also be added **after table creation**.

```sql
ALTER TABLE orders
ADD CONSTRAINT fk_orders_user
FOREIGN KEY (user_id)
REFERENCES users(id);
```

---

## 6. Foreign Key with ON DELETE & ON UPDATE

These rules define what happens when parent data changes.

### 6.1 ON DELETE Options

| Option    | Behavior                         |
| --------- | -------------------------------- |
| CASCADE   | Deletes child rows automatically |
| SET NULL  | Sets foreign key to NULL         |
| RESTRICT  | Prevents delete                  |
| NO ACTION | Same as RESTRICT                 |

Example:

```sql
ALTER TABLE orders
ADD CONSTRAINT fk_orders_user
FOREIGN KEY (user_id)
REFERENCES users(id)
ON DELETE CASCADE;
```

---

### 6.2 ON UPDATE Options

```sql
ALTER TABLE orders
ADD CONSTRAINT fk_orders_user
FOREIGN KEY (user_id)
REFERENCES users(id)
ON UPDATE CASCADE;
```

---

## 7. Foreign Key with NOT NULL

```sql
CREATE TABLE orders (
  id SERIAL PRIMARY KEY,
  user_id INTEGER NOT NULL,
  CONSTRAINT fk_user
  FOREIGN KEY (user_id)
  REFERENCES users(id)
);
```

✔ Ensures every order must belong to a user.

---

## 8. Composite Foreign Key

A foreign key can reference **multiple columns**.

```sql
CREATE TABLE enrollments (
  student_id INTEGER,
  course_id INTEGER,
  PRIMARY KEY (student_id, course_id)
);

CREATE TABLE grades (
  student_id INTEGER,
  course_id INTEGER,
  grade INTEGER,
  FOREIGN KEY (student_id, course_id)
  REFERENCES enrollments(student_id, course_id)
);
```

---

## 9. Common Foreign Key Errors

❌ Inserting invalid reference:

```sql
INSERT INTO orders (user_id) VALUES (999);
```

Error: foreign key violation

✔ Correct:

```sql
INSERT INTO orders (user_id) VALUES (1);
```

---

## 10. Dropping a Foreign Key Constraint

```sql
ALTER TABLE orders
DROP CONSTRAINT fk_orders_user;
```

---

## 11. Best Practices

- Always index foreign key columns
- Use meaningful constraint names
- Avoid unnecessary cascading deletes
- Enforce foreign keys at database level

---

## 12. Summary

- Foreign keys enforce relationships between tables
- They prevent invalid references
- Can be added during or after table creation
- PostgreSQL supports advanced FK rules

---

**Author:** Md Rafiq Mia
**Use Case:** SQL & PostgreSQL Learning / GitHub Documentation
