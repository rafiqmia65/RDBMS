# GROUP BY & HAVING Explained (SQL & PostgreSQL)

This document provides a **complete and professional explanation of GROUP BY**, **aggregate functions**, and **HAVING clause** in **SQL & PostgreSQL**. It includes **all common group-related functions with clear examples**, suitable for `README.md`, GitHub documentation, and interview preparation.

---

## 1. What Is GROUP BY?

`GROUP BY` is used to **group rows that have the same values** in specified columns and apply **aggregate functions** on each group.

Without `GROUP BY`, aggregate functions work on the **entire table**.

---

## 2. Basic GROUP BY Syntax

```sql
SELECT column_name, AGGREGATE_FUNCTION(column)
FROM table_name
GROUP BY column_name;
```

---

## 3. Aggregate Functions Used with GROUP BY

These functions are commonly used in grouped queries:

| Function | Description    |
| -------- | -------------- |
| COUNT()  | Number of rows |
| SUM()    | Total value    |
| AVG()    | Average value  |
| MIN()    | Minimum value  |
| MAX()    | Maximum value  |

---

## 4. GROUP BY with COUNT()

```sql
SELECT department, COUNT(*) AS total_employees
FROM employees
GROUP BY department;
```

---

## 5. GROUP BY with SUM()

```sql
SELECT department, SUM(salary) AS total_salary
FROM employees
GROUP BY department;
```

---

## 6. GROUP BY with AVG()

```sql
SELECT department, AVG(salary) AS avg_salary
FROM employees
GROUP BY department;
```

---

## 7. GROUP BY with MIN() & MAX()

```sql
SELECT department,
       MIN(salary) AS min_salary,
       MAX(salary) AS max_salary
FROM employees
GROUP BY department;
```

---

## 8. GROUP BY with Multiple Columns

```sql
SELECT department, role, COUNT(*) AS total
FROM employees
GROUP BY department, role;
```

Each unique `(department, role)` pair forms a group.

---

## 9. WHERE vs HAVING (Important)

| WHERE                 | HAVING              |
| --------------------- | ------------------- |
| Filters rows          | Filters groups      |
| Used before GROUP BY  | Used after GROUP BY |
| Cannot use aggregates | Can use aggregates  |

---

## 10. GROUP BY with HAVING

`HAVING` filters grouped results using aggregate conditions.

```sql
SELECT department, COUNT(*) AS total_employees
FROM employees
GROUP BY department
HAVING COUNT(*) > 5;
```

---

## 11. GROUP BY with WHERE + HAVING

```sql
SELECT department, AVG(salary) AS avg_salary
FROM employees
WHERE is_active = true
GROUP BY department
HAVING AVG(salary) > 60000;
```

Execution order:

1. WHERE → filters rows
2. GROUP BY → creates groups
3. HAVING → filters groups

---

## 12. GROUP BY with DISTINCT

```sql
SELECT department, COUNT(DISTINCT role) AS total_roles
FROM employees
GROUP BY department;
```

---

## 13. GROUP BY with COALESCE

```sql
SELECT COALESCE(department, 'Unknown') AS department,
       COUNT(*) AS total
FROM employees
GROUP BY COALESCE(department, 'Unknown');
```

Handles NULL values safely in grouping.

---

## 14. GROUP BY with ORDER BY

```sql
SELECT department, SUM(salary) AS total_salary
FROM employees
GROUP BY department
ORDER BY total_salary DESC;
```

---

## 15. GROUP BY with LIMIT

```sql
SELECT department, COUNT(*) AS total
FROM employees
GROUP BY department
ORDER BY total DESC
LIMIT 5;
```

Returns top 5 groups.

---

## 16. Common GROUP BY Errors

❌ Selecting non-grouped columns:

```sql
SELECT department, name, COUNT(*)
FROM employees
GROUP BY department;
```

✔ Correct:

```sql
SELECT department, COUNT(*)
FROM employees
GROUP BY department;
```

---

## 17. Best Practices

- Always group non-aggregated columns
- Use WHERE before GROUP BY for performance
- Use HAVING only for aggregate conditions
- Use aliases for readability

---

## 18. Summary

- GROUP BY groups rows with same values
- Aggregate functions summarize grouped data
- HAVING filters grouped results
- PostgreSQL fully supports advanced grouping features

---

**Author:** Md Rafiq Mia
**Use Case:** SQL & PostgreSQL Learning / GitHub Documentation
