# Updating & Deleting Data (SQL & PostgreSQL)

This document provides a **professional guide to updating and deleting data** in **SQL and PostgreSQL**. It explains safe usage of `UPDATE` and `DELETE` statements, common patterns, and best practices. Suitable for `README.md`, GitHub documentation, and interview preparation.

---

## 1. Updating Data with UPDATE

The `UPDATE` statement is used to **modify existing records** in a table.

### Basic Syntax

```sql
UPDATE table_name
SET column1 = value1, column2 = value2
WHERE condition;
```

> ⚠️ Always use a `WHERE` clause to avoid updating all rows unintentionally.

---

## 2. UPDATE with WHERE Filtering

```sql
UPDATE users
SET is_active = false
WHERE last_login < '2024-01-01';
```

✔ Only rows matching the condition are updated.

---

## 3. Updating Multiple Columns

```sql
UPDATE employees
SET salary = salary + 5000,
    updated_at = NOW()
WHERE department = 'IT';
```

---

## 4. UPDATE Using Conditions and Expressions

```sql
UPDATE products
SET final_price = price - COALESCE(discount, 0);
```

This ensures safe calculations even when `discount` is NULL.

---

## 5. UPDATE with FROM (PostgreSQL)

PostgreSQL allows updating a table using values from another table.

```sql
UPDATE orders o
SET status = 'completed'
FROM payments p
WHERE o.id = p.order_id
  AND p.is_verified = true;
```

---

## 6. Returning Updated Rows (PostgreSQL)

```sql
UPDATE users
SET role = 'admin'
WHERE email = 'admin@mail.com'
RETURNING id, email, role;
```

Useful for APIs and audit logs.

---

## 7. Deleting Data with DELETE

The `DELETE` statement removes **existing rows** from a table.

### Basic Syntax

```sql
DELETE FROM table_name
WHERE condition;
```

> ⚠️ Without `WHERE`, all rows will be deleted.

---

## 8. DELETE with WHERE Filtering

```sql
DELETE FROM sessions
WHERE expires_at < NOW();
```

✔ Removes only expired sessions.

---

## 9. DELETE with RETURNING (PostgreSQL)

```sql
DELETE FROM users
WHERE is_active = false
RETURNING id, email;
```

Allows verification of deleted rows.

---

## 10. DELETE vs TRUNCATE

| Feature       | DELETE | TRUNCATE     |
| ------------- | ------ | ------------ |
| WHERE support | Yes    | No           |
| Rollback      | Yes    | No (usually) |
| Speed         | Slower | Faster       |
| Trigger fired | Yes    | No           |

Use `TRUNCATE` only when you want to **remove all rows quickly**.

---

## 11. Safe Update & Delete Practices

### Preview with SELECT

```sql
SELECT *
FROM users
WHERE is_active = false;
```

Verify affected rows before running UPDATE or DELETE.

---

## 12. Transactions for Safety

```sql
BEGIN;

DELETE FROM orders
WHERE status = 'cancelled';

ROLLBACK;  -- Undo
-- COMMIT; -- Apply permanently
```

Transactions prevent accidental data loss.

---

## 13. Best Practices

- Always use `WHERE` with UPDATE & DELETE
- Test queries using `SELECT` first
- Use transactions in production
- Use `RETURNING` for confirmation (PostgreSQL)
- Avoid mass updates during peak hours

---

## 14. Summary

- `UPDATE` modifies existing data
- `DELETE` removes existing rows
- `WHERE` controls affected records
- PostgreSQL provides `FROM` and `RETURNING` for advanced control

---

**Author:** Md Rafiq Mia
**Use Case:** SQL & PostgreSQL Learning / GitHub Documentation
